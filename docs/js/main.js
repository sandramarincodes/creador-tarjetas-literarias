const r=[document.querySelector("#title"),document.querySelector("#autor"),document.querySelector("#gender"),document.querySelector("#rate"),document.querySelector("#user")];function A(){var t,o,a,n,i;const e={title:((t=r[0])==null?void 0:t.value)||"",autor:((o=r[1])==null?void 0:o.value)||"",gender:((a=r[2])==null?void 0:a.value)||"",rate:((n=r[3])==null?void 0:n.value)||"",user:((i=r[4])==null?void 0:i.value)||""};localStorage.setItem("formData",JSON.stringify(e))}function T(){const e=localStorage.getItem("formData");if(e){const t=JSON.parse(e);r[0]&&(r[0].value=t.title||""),r[1]&&(r[1].value=t.autor||""),r[2]&&(r[2].value=t.gender||""),r[3]&&(r[3].value=t.rate||""),r[4]&&(r[4].value=t.user||"")}}r.forEach(e=>{e&&e.addEventListener("input",A)});window.addEventListener("DOMContentLoaded",T);const c=document.querySelector(".js_inputTitle"),u=document.querySelector(".js_inputAutor"),d=document.querySelector(".js_inputGender"),m=document.querySelector(".js_inputRate"),f=document.querySelector(".js_inputUserName"),h=document.querySelector(".js_buttonSubmit"),C=document.querySelector(".js_previewTitle"),I=document.querySelector(".js_previewAutor"),L=document.querySelector(".js_previewGender"),x=document.querySelector(".js_previewRate"),E=document.querySelector(".js_previewUserName");function D(e){let t="";e==1?t="‚≠ê":e==2?t="‚≠ê‚≠ê":e==3?t="‚≠ê‚≠ê‚≠ê":e==4?t="‚≠ê‚≠ê‚≠ê‚≠ê":(e==5,t="‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê"),x.textContent=t}function g(){C.textContent=c.value||"T√≠tulo del libro",I.textContent=u.value||"Autor/a",L.textContent=d.value||"G√©nero",E.textContent=f.value||"Nombre o usuario",D(m.value)}c&&c.addEventListener("input",g);u&&u.addEventListener("input",g);d&&d.addEventListener("input",g);m&&m.addEventListener("input",g);f&&f.addEventListener("input",g);function $(){let e="";const t=document.querySelectorAll(".js-fondo-radio");for(const o of t)if(o.checked){e=o.value;break}return{field1:1,field2:c.value,field3:u.value,field4:d.value,field5:m.value,field6:f.value,field7:e,photo:window.photo}}function R(e){e.preventDefault();const t=$();fetch("https://dev.adalab.es/api/info/data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(o=>o.json()).then(o=>{if(console.log("Respuesta del servidor:",o),o.success){const a=o.infoID;console.log("UUID generado:",a),window.open(`./card.html?id=${a}`,"_blank")}else console.error("Error al crear la tarjeta:",o.error)})}h&&h.addEventListener("click",R);const b=document.querySelectorAll(".js_toggle");for(const e of b)e.addEventListener("click",t=>{const o=e.nextElementSibling,a=o.classList.contains("is-open");for(const n of b){n.nextElementSibling.classList.remove("is-open");const v=n.querySelector(".form__section-title");v&&v.dataset.label&&(v.textContent=`${v.dataset.label} üìò`)}if(!a){o.classList.add("is-open");const n=e.querySelector(".form__section-title");n&&n.dataset.label&&(n.textContent=`${n.dataset.label} üìñ`)}});const j=document.querySelector(".js_cardPreview"),P=document.querySelectorAll(".js-fondo-radio");P.forEach(e=>{e.addEventListener("change",t=>{const o=t.target.value;j.classList.remove("romance","misterio","poesia","fantasia","cienciaficcion"),j.classList.add(o)})});const q=document.querySelector(".js_resetBtn");function U(){c.value="",u.value="",d.value="",m.value="",f.value="",C.textContent="T√≠tulo del libro",I.textContent="Autor/a",L.textContent="G√©nero",x.textContent="‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê",E.textContent="Nombre y apellidos",l.removeAttribute("style"),w.removeAttribute("style"),S.value=""}q&&q.addEventListener("click",U);window.photo="";const S=document.querySelector(".js__profile-upload-btn"),w=document.querySelector(".js__profile-preview"),l=document.querySelector(".js__profile-image"),p=new FileReader;function G(){w.style.backgroundImage=`url(${p.result})`,console.log("Imagen cargada:",p.result)}function N(){window.photo=p.result,l.style.backgroundImage=`url(${window.photo})`,l.style.backgroundSize="cover",l.style.backgroundPosition="center",l.style.backgroundRepeat="no-repeat",G()}function F(e){const t=e.currentTarget.files[0];t?(p.addEventListener("load",N,{once:!0}),p.readAsDataURL(t)):(l.style.backgroundImage="",w.style.backgroundImage="")}S&&S.addEventListener("change",F);const k=document.querySelector(".js_card");if(k){const t=new URLSearchParams(window.location.search).get("id");fetch(`https://dev.adalab.es/api/info/${t}`).then(o=>o.json()).then(o=>{o.success?O(o.data):console.error("Error al obtener la tarjeta:",o.error)}).catch(o=>{console.error("Error en la petici√≥n:",o)})}function O(e){k.innerHTML=`
  <article class="cardPreview ${e.field7}">
      <h2 class="card__title">${e.field2}</h2>               <!-- T√≠tulo -->
      <p class="card__author">${e.field3}</p>                <!-- Autor -->
      <p class="card__gender">${e.field4}</p>                <!-- G√©nero -->
      <p class="card__stars">${"‚≠ê".repeat(e.field5)}</p>     <!-- Valoraci√≥n -->
      <img class="card__image profile__image" src="${e.photo}" alt="Imagen del libro o recomendaci√≥n"/> <!-- Imagen -->
      <p class="card__user">Recomendado por: ${e.field6}</p> <!-- Usuario -->
    </article>
  `}const s=document.querySelector(".js__profile-upload-btn"),y=document.querySelector(".js_imageError"),_=document.querySelector(".js__profile-preview");s&&s.addEventListener("change",e=>{const t=e.target.files[0];if(!t)return;const o=5*1024,a=["image/jpeg","image/png","image/gif"];if(t.size>o){y.textContent="‚ùå Tu imagen es demasiado grande. Selecciona una con m√°ximo 5KB.",s.value="",window.photo=null,_.style.backgroundImage="url('./images/Image_example.jpg')";return}if(!a.includes(t.type)){y.textContent="‚ùå Formato no v√°lido. Usa JPG, PNG o GIF.",s.value="",window.photo=null,_.style.backgroundImage="url('./images/Image_example.jpg')";return}const n=new FileReader;n.onload=function(){const i=new Image;i.onload=()=>{y.textContent="",window.photo=n.result,_.style.backgroundImage=`url('${n.result}')`},i.onerror=()=>{y.textContent="‚ùå Tu imagen no se puede usar. El archivo est√° da√±ado.",s.value="",window.photo=null,_.style.backgroundImage="url('./images/Image_example.jpg')"},i.src=n.result},n.readAsDataURL(t)});
//# sourceMappingURL=main.js.map
